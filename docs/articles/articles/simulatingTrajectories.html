<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulating trajectories â€¢ sRACIPE</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Simulating trajectories">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">sRACIPE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/sRACIPE.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/simulatingTrajectories.html">Simulating trajectories</a>
    </li>
    <li>
      <a href="../../articles/articles/singleModelSimulations.html">Single Model Simulations</a>
    </li>
    <li>
      <a href="../../articles/articles/underTheHood.html">Under the hood - design and implementation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vivekkohar/sRACIPE">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Simulating trajectories</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/vivekkohar/sRACIPE/blob/master/vignettes/articles/simulatingTrajectories.Rmd"><code>vignettes/articles/simulatingTrajectories.Rmd</code></a></small>
      <div class="hidden name"><code>simulatingTrajectories.Rmd</code></div>

    </div>

    
    
<div id="simulating-a-circuit" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-a-circuit" class="anchor"></a>Simulating a circuit</h2>
<p>Typically we use sRACIPE to simulate the steady state solutions but one can also simulate the trajectories to study the effect of perturbations on the clusters. Here we will show a pipeline to study the effect of perturbations on the clusters.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Load sRACIPE package</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sRACIPE)))</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a>racipe &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/RacipeSE.html">RacipeSE</a></span>() <span class="co"># Construct an empty RacipeSE object</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"EMT2"</span>) <span class="co"># Load a sample circuit</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw"><a href="../../reference/sracipeCircuit.html">sracipeCircuit</a></span>(racipe) &lt;-<span class="st"> </span>EMT2</span></code></pre></div>
<pre><code>## circuit file successfully loaded</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Simulate the circuit</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>racipe &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/sracipeSimulate.html">sracipeSimulate</a></span>(racipe, <span class="dt">numModels =</span> <span class="dv">100</span>, <span class="dt">plots =</span> <span class="ot">FALSE</span>, <span class="dt">genIC =</span> <span class="ot">TRUE</span>, </span>
<span id="cb3-3"><a href="#cb3-3"></a>                         <span class="dt">genParams =</span> <span class="ot">TRUE</span>, <span class="dt">integrate =</span> <span class="ot">TRUE</span>, </span>
<span id="cb3-4"><a href="#cb3-4"></a>                         <span class="dt">integrateStepSize =</span> <span class="fl">0.05</span>,</span>
<span id="cb3-5"><a href="#cb3-5"></a>                         <span class="dt">simulationTime =</span> <span class="dv">50</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>                         )</span></code></pre></div>
<pre><code>## Generating gene thresholds</code></pre>
<pre><code>## generating thresholds for uniform distribution1...</code></pre>
<pre><code>## Running the simulations</code></pre>
<pre><code>## ========================================</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Calculate the mean and sd from the unnormalized data.</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co"># These will be later used to normalize any new data.</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>simExp &lt;-<span class="st"> </span><span class="kw">assay</span>(racipe)</span>
<span id="cb8-4"><a href="#cb8-4"></a>simExp &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="dv">1</span><span class="op">+</span>simExp)</span>
<span id="cb8-5"><a href="#cb8-5"></a>tmpMeans &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(simExp)</span>
<span id="cb8-6"><a href="#cb8-6"></a>tmpSds &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(simExp,<span class="dv">1</span>,sd)</span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co"># Normalize the data</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>racipeNorm &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/sracipeNormalize.html">sracipeNormalize</a></span>(racipe)</span>
<span id="cb8-10"><a href="#cb8-10"></a>simExp &lt;-<span class="st"> </span><span class="kw">assay</span>(racipeNorm) <span class="co"># extract the simulated gene expression</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>pca &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(simExp)) <span class="co"># Plot the simulated data on PCA</span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">## Define a function to plot pca datapoints</span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co"># Load the ggplot2 </span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="kw"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)))</span>
<span id="cb8-15"><a href="#cb8-15"></a></span>
<span id="cb8-16"><a href="#cb8-16"></a>sracipePlotPcaPoints &lt;-<span class="st"> </span><span class="cf">function</span>(plotData, <span class="dt">xmin=</span><span class="op">-</span><span class="dv">2</span>,<span class="dt">xmax=</span><span class="dv">2</span>,<span class="dt">ymin=</span><span class="op">-</span><span class="dv">2</span>,<span class="dt">ymax=</span><span class="dv">2</span>){</span>
<span id="cb8-17"><a href="#cb8-17"></a>  pcaData &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">x=</span>plotData[,<span class="dv">1</span>],<span class="dt">y=</span>plotData[,<span class="dv">2</span>])</span>
<span id="cb8-18"><a href="#cb8-18"></a>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span>(ggplot2)</span>
<span id="cb8-19"><a href="#cb8-19"></a>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(pcaData) <span class="op">+</span></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="st">      </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> pcaData[,<span class="dv">1</span>], <span class="dt">y =</span>pcaData[,<span class="dv">2</span>])) <span class="op">+</span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="st">      </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"PC1("</span>,<span class="dv">100</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(pca)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="dv">1</span>],<span class="st">"%)"</span>)) <span class="op">+</span></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="st">      </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"PC2("</span>,<span class="dv">100</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(pca)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="dv">2</span>],<span class="st">"%)"</span>)) <span class="op">+</span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="st">      </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span>(xmin,xmax) <span class="op">+</span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="st">      </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span>(ymin,ymax) <span class="op">+</span></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="st">      </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span></span>
<span id="cb8-26"><a href="#cb8-26"></a><span class="st">      </span><span class="ot">NULL</span>)</span>
<span id="cb8-27"><a href="#cb8-27"></a>}</span>
<span id="cb8-28"><a href="#cb8-28"></a></span>
<span id="cb8-29"><a href="#cb8-29"></a><span class="kw">sracipePlotPcaPoints</span>(pca<span class="op">$</span>x,<span class="dt">xmin=</span><span class="op">-</span><span class="dv">6</span>,<span class="dt">xmax=</span><span class="dv">6</span>,<span class="dt">ymin=</span><span class="op">-</span><span class="dv">4</span>,<span class="dt">ymax=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="simulatingTrajectories_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
</div>
<div id="selecting-models-belonging-to-a-cluster" class="section level2">
<h2 class="hasAnchor">
<a href="#selecting-models-belonging-to-a-cluster" class="anchor"></a>Selecting models belonging to a cluster</h2>
<p>Now we can cluster the models and perturb models belonging to that cluster.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Define the distance function</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>distfun=<span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span>((<span class="dv">1</span><span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(x), <span class="dt">method =</span> <span class="st">"s"</span>))<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a>distance &lt;-<span class="st"> </span><span class="kw">distfun</span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(simExp)) <span class="co"># Compute the distance</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># Perform heirarchical clustering</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>clusters &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(distance, <span class="dt">method =</span> <span class="st">"ward.D2"</span> )</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co"># Select the number of clusters</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>nClusters &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co"># Obtain the cluster assignment of each model </span></span>
<span id="cb9-9"><a href="#cb9-9"></a>assignedClusters &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span>(clusters, nClusters)</span>
<span id="cb9-10"><a href="#cb9-10"></a></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co"># Define a function to plot the heirarchical clustering data</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>sracipePlotHeatmap &lt;-<span class="st"> </span><span class="cf">function</span>(plotData, assignedClusters, <span class="dt">col =</span> <span class="ot">NULL</span>, </span>
<span id="cb9-13"><a href="#cb9-13"></a>                               <span class="dt">col2 =</span> <span class="ot">NULL</span>, </span>
<span id="cb9-14"><a href="#cb9-14"></a>                               ...) {</span>
<span id="cb9-15"><a href="#cb9-15"></a>  <span class="cf">if</span>(<span class="kw"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(col))  col &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#5E4FA2"</span>, <span class="st">"#4F61AA"</span>, <span class="st">"#4173B3"</span>, <span class="st">"#3386BC"</span>, <span class="st">"#4198B6"</span>,</span>
<span id="cb9-16"><a href="#cb9-16"></a>               <span class="st">"#51ABAE"</span>, <span class="st">"#62BEA6"</span>, <span class="st">"#77C8A4"</span>, <span class="st">"#8ED1A4"</span>, <span class="st">"#A4DAA4"</span>,</span>
<span id="cb9-17"><a href="#cb9-17"></a>               <span class="st">"#B8E2A1"</span>, <span class="st">"#CBEA9D"</span>, <span class="st">"#DEF199"</span>, <span class="st">"#EAF69F"</span>, <span class="st">"#F2FAAC"</span>,</span>
<span id="cb9-18"><a href="#cb9-18"></a>               <span class="st">"#FAFDB8"</span>, <span class="st">"#FEFAB6"</span>, <span class="st">"#FEF0A5"</span>, <span class="st">"#FEE695"</span>, <span class="st">"#FDD985"</span>,</span>
<span id="cb9-19"><a href="#cb9-19"></a>               <span class="st">"#FDC978"</span>, <span class="st">"#FDB96A"</span>, <span class="st">"#FCA75E"</span>, <span class="st">"#F99254"</span>, <span class="st">"#F67D4A"</span>,</span>
<span id="cb9-20"><a href="#cb9-20"></a>               <span class="st">"#F26943"</span>, <span class="st">"#E85A47"</span>, <span class="st">"#DE4B4B"</span>, <span class="st">"#D33C4E"</span>, <span class="st">"#C1284A"</span>,</span>
<span id="cb9-21"><a href="#cb9-21"></a>               <span class="st">"#AF1446"</span>, <span class="st">"#9E0142"</span>)</span>
<span id="cb9-22"><a href="#cb9-22"></a>  <span class="cf">if</span>(<span class="kw"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(col2))  col2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>,</span>
<span id="cb9-23"><a href="#cb9-23"></a>          <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>)</span>
<span id="cb9-24"><a href="#cb9-24"></a></span>
<span id="cb9-25"><a href="#cb9-25"></a>    clustNames &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(assignedClusters)</span>
<span id="cb9-26"><a href="#cb9-26"></a>    nClusters &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(clustNames)</span>
<span id="cb9-27"><a href="#cb9-27"></a>    clustColors &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(assignedClusters))</span>
<span id="cb9-28"><a href="#cb9-28"></a>    <span class="cf">for</span>(tmp1 <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(clustColors))){</span>
<span id="cb9-29"><a href="#cb9-29"></a>      clustColors[tmp1] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(clustNames <span class="op">==</span><span class="st"> </span>assignedClusters[tmp1] )</span>
<span id="cb9-30"><a href="#cb9-30"></a>    }</span>
<span id="cb9-31"><a href="#cb9-31"></a>    clustColors &lt;-<span class="st"> </span>col2[clustColors]</span>
<span id="cb9-32"><a href="#cb9-32"></a>   <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(clustColors) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(assignedClusters)</span>
<span id="cb9-33"><a href="#cb9-33"></a>   <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span>(gplots)</span>
<span id="cb9-34"><a href="#cb9-34"></a>  gplots<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/gplots/man/heatmap.2.html">heatmap.2</a></span>(plotData, </span>
<span id="cb9-35"><a href="#cb9-35"></a>                    <span class="dt">col=</span>col, </span>
<span id="cb9-36"><a href="#cb9-36"></a>                    <span class="dt">hclustfun =</span> <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(x,<span class="dt">method =</span> <span class="st">'ward.D2'</span>), </span>
<span id="cb9-37"><a href="#cb9-37"></a>       <span class="dt">distfun=</span><span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span>((<span class="dv">1</span><span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(x), <span class="dt">method =</span> <span class="st">"s"</span>))<span class="op">/</span><span class="dv">2</span>), </span>
<span id="cb9-38"><a href="#cb9-38"></a>                    <span class="dt">trace=</span><span class="st">"none"</span>,</span>
<span id="cb9-39"><a href="#cb9-39"></a>  <span class="dt">ColSideColors =</span> clustColors, <span class="dt">labCol =</span> <span class="ot">FALSE</span>,</span>
<span id="cb9-40"><a href="#cb9-40"></a>    <span class="dt">xlab=</span><span class="st">"Models"</span>,</span>
<span id="cb9-41"><a href="#cb9-41"></a>    <span class="dt">margins =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb9-42"><a href="#cb9-42"></a>    )</span>
<span id="cb9-43"><a href="#cb9-43"></a>}</span>
<span id="cb9-44"><a href="#cb9-44"></a><span class="co"># Plot the data</span></span>
<span id="cb9-45"><a href="#cb9-45"></a><span class="kw">sracipePlotHeatmap</span>(simExp, <span class="dt">assignedClusters =</span> assignedClusters)</span></code></pre></div>
<pre><code>## Loading required package: gplots</code></pre>
<pre><code>## 
## Attaching package: 'gplots'</code></pre>
<pre><code>## The following object is masked from 'package:IRanges':
## 
##     space</code></pre>
<pre><code>## The following object is masked from 'package:S4Vectors':
## 
##     space</code></pre>
<pre><code>## The following object is masked from 'package:stats':
## 
##     lowess</code></pre>
<p><img src="simulatingTrajectories_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># Select the models belonging to first cluster</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>selectedModels &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(assignedClusters <span class="op">==</span><span class="dv">1</span>) </span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co"># Plot the selected models on PC plot</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>tmp &lt;-<span class="st"> </span>pca<span class="op">$</span>x[selectedModels,]</span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="kw">sracipePlotPcaPoints</span>(<span class="dt">plotData =</span> tmp,<span class="dt">xmin=</span><span class="op">-</span><span class="dv">6</span>,<span class="dt">xmax=</span><span class="dv">6</span>,<span class="dt">ymin=</span><span class="op">-</span><span class="dv">4</span>,<span class="dt">ymax=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="simulatingTrajectories_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
</div>
<div id="simulating-a-subset-of-models" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-a-subset-of-models" class="anchor"></a>Simulating a subset of models</h2>
<p>Now we select the models belonging to first cluster and decrease the ZEB1 production rate.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Create a new racipe object with models from the selected cluster</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>subRacipe &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/RacipeSE.html">RacipeSE</a></span>(racipe[,selectedModels])</span>
<span id="cb16-3"><a href="#cb16-3"></a>subRacipe  </span></code></pre></div>
<pre><code>## class: RacipeSE 
## dim: 22 45 
## metadata(4): annotation nInteractions config normalized
## assays(1): deterministic
## rownames(22): FOXC2 KLF8 ... CDH1 CDH2
## rowData names(22): FOXC2 KLF8 ... CDH1 CDH2
## colnames: NULL
## colData names(312): G_FOXC2 G_KLF8 ... CDH1 CDH2</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>numModels &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(subRacipe)[<span class="dv">2</span>]</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co"># modify the parameters</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>params &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/sracipeParams.html">sracipeParams</a></span>(subRacipe)</span>
<span id="cb18-4"><a href="#cb18-4"></a>params[<span class="st">"G_ZEB1"</span>] &lt;-<span class="st"> </span><span class="fl">0.01</span><span class="op">*</span>params[<span class="st">"G_ZEB1"</span>]</span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="kw"><a href="../../reference/sracipeParams.html">sracipeParams</a></span>(subRacipe) &lt;-<span class="st"> </span>params</span>
<span id="cb18-6"><a href="#cb18-6"></a></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co"># Use the steady state solutions of the models as the initial conditin</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>ic &lt;-<span class="st"> </span><span class="kw">assay</span>(subRacipe,<span class="dv">1</span>)</span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="kw"><a href="../../reference/sracipeIC.html">sracipeIC</a></span>(subRacipe) &lt;-<span class="st"> </span>ic</span>
<span id="cb18-10"><a href="#cb18-10"></a></span>
<span id="cb18-11"><a href="#cb18-11"></a></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="co"># We will record the state at 0.05 intervals. For an integrateStepSize of 0.01,</span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co"># this implies that simulation results at every 5th time point are recorded.</span></span>
<span id="cb18-14"><a href="#cb18-14"></a>subRacipeTS &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/sracipeSimulate.html">sracipeSimulate</a></span>(subRacipe, <span class="dt">numModels =</span> numModels, </span>
<span id="cb18-15"><a href="#cb18-15"></a>                             <span class="dt">plots =</span> <span class="ot">FALSE</span>, <span class="dt">genIC =</span> <span class="ot">FALSE</span>, </span>
<span id="cb18-16"><a href="#cb18-16"></a>                         <span class="dt">genParams =</span> <span class="ot">FALSE</span>, <span class="dt">integrate =</span> <span class="ot">TRUE</span>, </span>
<span id="cb18-17"><a href="#cb18-17"></a>                         <span class="dt">integrateStepSize =</span> <span class="fl">0.01</span>,</span>
<span id="cb18-18"><a href="#cb18-18"></a>                         <span class="dt">simulationTime =</span> <span class="dv">10</span>, <span class="dt">printInterval =</span> <span class="fl">0.05</span>, <span class="dt">printStart =</span> <span class="dv">0</span></span>
<span id="cb18-19"><a href="#cb18-19"></a>                         )</span></code></pre></div>
<pre><code>## Running the simulations</code></pre>
<pre><code>## ====================</code></pre>
</div>
<div id="preprocessing-time-series-data" class="section level2">
<h2 class="hasAnchor">
<a href="#preprocessing-time-series-data" class="anchor"></a>Preprocessing time series data</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># Lets define a function to process the time series data.</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co"># We should process all data uniformly to observe how changing a parameter</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="co"># affects the trajectories of the cluster.</span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="co"># Use the mean and standard deviation from the original simulation to normalize.</span></span>
<span id="cb21-5"><a href="#cb21-5"></a></span>
<span id="cb21-6"><a href="#cb21-6"></a>processData &lt;-<span class="st"> </span><span class="cf">function</span>(racipe,counter,time){</span>
<span id="cb21-7"><a href="#cb21-7"></a>  newExpData &lt;-<span class="st"> </span><span class="kw">assay</span>(racipe,counter) <span class="co"># data from different timepoints</span></span>
<span id="cb21-8"><a href="#cb21-8"></a>  newExpData &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="dv">1</span><span class="op">+</span>newExpData) <span class="co"># Log transform</span></span>
<span id="cb21-9"><a href="#cb21-9"></a>  newExpData &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sweep.html">sweep</a></span>(newExpData, <span class="dv">1</span>, tmpMeans, <span class="dt">FUN =</span> <span class="st">"-"</span>) <span class="co"># scale</span></span>
<span id="cb21-10"><a href="#cb21-10"></a>  newExpData &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sweep.html">sweep</a></span>(newExpData, <span class="dv">1</span>, tmpSds, <span class="dt">FUN =</span> <span class="st">"/"</span>) <span class="co"># scale</span></span>
<span id="cb21-11"><a href="#cb21-11"></a>  newPca &lt;-<span class="st"> </span>(<span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(newExpData), pca<span class="op">$</span>center, pca<span class="op">$</span>scale) <span class="op">%*%</span></span>
<span id="cb21-12"><a href="#cb21-12"></a><span class="st">             </span>pca<span class="op">$</span>rotation)</span>
<span id="cb21-13"><a href="#cb21-13"></a>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">PC1=</span>newPca[,<span class="dv">1</span>],<span class="dt">PC2=</span>newPca[,<span class="dv">2</span>], <span class="dt">Time =</span> time))</span>
<span id="cb21-14"><a href="#cb21-14"></a>}</span>
<span id="cb21-15"><a href="#cb21-15"></a>trajectoriesAll &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>()</span>
<span id="cb21-16"><a href="#cb21-16"></a>trajectoriesAll &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">processData</span>(subRacipe,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb21-17"><a href="#cb21-17"></a>models &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span><span class="op">:</span>numModels)</span>
<span id="cb21-18"><a href="#cb21-18"></a>trajectoriesAll<span class="op">$</span>Model &lt;-<span class="st"> </span>models</span>
<span id="cb21-19"><a href="#cb21-19"></a>nTimePoints &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">assays</span>(subRacipeTS))</span>
<span id="cb21-20"><a href="#cb21-20"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>nTimePoints)</span>
<span id="cb21-21"><a href="#cb21-21"></a>{</span>
<span id="cb21-22"><a href="#cb21-22"></a>  exp &lt;-<span class="st"> </span><span class="kw">processData</span>(subRacipeTS,i,(i<span class="dv">-1</span>)<span class="op">*</span><span class="fl">0.05</span>)</span>
<span id="cb21-23"><a href="#cb21-23"></a>  exp<span class="op">$</span>Model &lt;-<span class="st"> </span>models</span>
<span id="cb21-24"><a href="#cb21-24"></a>  trajectoriesAll &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(trajectoriesAll,exp)</span>
<span id="cb21-25"><a href="#cb21-25"></a>}</span>
<span id="cb21-26"><a href="#cb21-26"></a></span>
<span id="cb21-27"><a href="#cb21-27"></a>p &lt;-<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(trajectoriesAll) <span class="op">+</span></span>
<span id="cb21-28"><a href="#cb21-28"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"PC1("</span>,<span class="dv">100</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(pca)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="dv">1</span>],<span class="st">"%)"</span>)) <span class="op">+</span></span>
<span id="cb21-29"><a href="#cb21-29"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"PC2("</span>,<span class="dv">100</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(pca)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="dv">2</span>],<span class="st">"%)"</span>)) <span class="op">+</span></span>
<span id="cb21-30"><a href="#cb21-30"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> PC1, <span class="dt">y =</span>PC2, <span class="dt">color =</span> Time), <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb21-31"><a href="#cb21-31"></a><span class="st"> </span><span class="co"># ggtitle(" Time = 2000") +</span></span>
<span id="cb21-32"><a href="#cb21-32"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span></span>
<span id="cb21-33"><a href="#cb21-33"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">text =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">size=</span><span class="dv">15</span>))</span>
<span id="cb21-34"><a href="#cb21-34"></a></span>
<span id="cb21-35"><a href="#cb21-35"></a>p</span></code></pre></div>
<p><img src="simulatingTrajectories_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="plotting-averaged-values-with-errorbars" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-averaged-values-with-errorbars" class="anchor"></a>Plotting averaged values with errorbars</h2>
<p>We can also observe how the mean and standard deviation of the models change upon parameter perturbation. The graph shown below shows how the PC1 and PC2 change over time.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>pcaSimValues &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(data.frame, <span class="kw"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span>(. <span class="op">~</span><span class="st"> </span>Time, trajectoriesAll[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">mean =</span> <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(x), <span class="dt">sd =</span> <span class="kw"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(x))))</span>
<span id="cb22-2"><a href="#cb22-2"></a>p &lt;-<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(pcaSimValues) <span class="op">+</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> PC1.mean, <span class="dt">y =</span>PC2.mean, <span class="dt">color =</span> Time), <span class="dt">alpha =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> PC1.mean, <span class="dt">y =</span>PC2.mean),<span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> PC1.mean, <span class="dt">color =</span> Time,<span class="dt">ymin =</span> (PC2.mean <span class="op">-</span><span class="st"> </span>PC2.sd),<span class="dt">ymax =</span> (PC2.mean <span class="op">+</span><span class="st"> </span>PC2.sd)), <span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_errorbarh.html">geom_errorbarh</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>( <span class="dt">y =</span>PC2.mean, <span class="dt">color =</span> Time,<span class="dt">xmin =</span> (PC1.mean <span class="op">-</span><span class="st"> </span>PC1.sd),<span class="dt">xmax =</span> (PC1.mean <span class="op">+</span><span class="st"> </span>PC1.sd)), <span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"PC1("</span>,<span class="dv">100</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(pca)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="dv">1</span>],<span class="st">"%)"</span>)) <span class="op">+</span></span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"PC2("</span>,<span class="dv">100</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(pca)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="dv">2</span>],<span class="st">"%)"</span>)) <span class="op">+</span></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span></span>
<span id="cb22-10"><a href="#cb22-10"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">text =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">size=</span><span class="dv">20</span>),</span>
<span id="cb22-11"><a href="#cb22-11"></a>        <span class="dt">legend.text =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">size=</span><span class="dv">15</span>),</span>
<span id="cb22-12"><a href="#cb22-12"></a>        <span class="dt">legend.spacing.y =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/reexports.html">unit</a></span>(.<span class="dv">10</span>, <span class="st">'cm'</span>),</span>
<span id="cb22-13"><a href="#cb22-13"></a>        <span class="dt">legend.spacing.x =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/reexports.html">unit</a></span>(.<span class="dv">10</span>, <span class="st">'cm'</span>)</span>
<span id="cb22-14"><a href="#cb22-14"></a>  ) </span>
<span id="cb22-15"><a href="#cb22-15"></a>p</span></code></pre></div>
<p><img src="simulatingTrajectories_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div id="creating-a-movie" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-movie" class="anchor"></a>Creating a movie</h2>
<p>One can also create a movie using <code>gganimate</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(gganimate)</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(transformr)</span>
<span id="cb23-3"><a href="#cb23-3"></a></span>
<span id="cb23-4"><a href="#cb23-4"></a>p &lt;-<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(pcaSimValues[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,]) <span class="op">+</span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> PC1.mean, <span class="dt">y =</span>PC2.mean, <span class="dt">color =</span> Time)) <span class="op">+</span></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"PC1("</span>,<span class="dv">100</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(pca)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="dv">1</span>],<span class="st">"%)"</span>)) <span class="op">+</span></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"PC2("</span>,<span class="dv">100</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(pca)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="dv">2</span>],<span class="st">"%)"</span>)) <span class="op">+</span></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="st">  </span><span class="kw"><a href="https://gganimate.com/reference/transition_states.html">transition_states</a></span>(</span>
<span id="cb23-10"><a href="#cb23-10"></a>    Time,</span>
<span id="cb23-11"><a href="#cb23-11"></a> <span class="dt">wrap=</span><span class="ot">FALSE</span></span>
<span id="cb23-12"><a href="#cb23-12"></a>  ) <span class="op">+</span></span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="st">  </span><span class="kw"><a href="https://gganimate.com/reference/shadow_mark.html">shadow_mark</a></span>() <span class="op">+</span></span>
<span id="cb23-14"><a href="#cb23-14"></a><span class="st">  </span><span class="kw"><a href="https://gganimate.com/reference/enter_exit.html">enter_fade</a></span>() <span class="op">+</span></span>
<span id="cb23-15"><a href="#cb23-15"></a><span class="st">  </span><span class="kw"><a href="https://gganimate.com/reference/enter_exit.html">exit_shrink</a></span>() <span class="op">+</span></span>
<span id="cb23-16"><a href="#cb23-16"></a><span class="st">  </span><span class="kw"><a href="https://gganimate.com/reference/ease_aes.html">ease_aes</a></span>(<span class="st">'sine-in-out'</span>)</span>
<span id="cb23-17"><a href="#cb23-17"></a><span class="co">#  NULL</span></span>
<span id="cb23-18"><a href="#cb23-18"></a><span class="kw"><a href="https://gganimate.com/reference/animate.html">animate</a></span>(p, <span class="dt">renderer =</span> <span class="kw"><a href="https://gganimate.com/reference/renderers.html">ffmpeg_renderer</a></span>(),<span class="dt">nframes =</span> <span class="dv">199</span>)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#simulating-a-circuit">Simulating a circuit</a></li>
      <li><a href="#selecting-models-belonging-to-a-cluster">Selecting models belonging to a cluster</a></li>
      <li><a href="#simulating-a-subset-of-models">Simulating a subset of models</a></li>
      <li><a href="#preprocessing-time-series-data">Preprocessing time series data</a></li>
      <li><a href="#plotting-averaged-values-with-errorbars">Plotting averaged values with errorbars</a></li>
      <li><a href="#creating-a-movie">Creating a movie</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://vivekkohar.github.io/">Vivek Kohar</a>, <a href="http://lusystemsbio.com/">Mingyang Lu</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
