<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Under the hood - design and implementation â€¢ sRACIPE</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Under the hood - design and implementation">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">sRACIPE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/sRACIPE.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/simulatingTrajectories.html">Simulating trajectories</a>
    </li>
    <li>
      <a href="../../articles/articles/singleModelSimulations.html">Single Model Simulations</a>
    </li>
    <li>
      <a href="../../articles/articles/underTheHood.html">Under the hood - design and implementation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vivekkohar/sRACIPE">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Under the hood - design and implementation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/vivekkohar/sRACIPE/blob/master/vignettes/articles/underTheHood.Rmd"><code>vignettes/articles/underTheHood.Rmd</code></a></small>
      <div class="hidden name"><code>underTheHood.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>We discuss the design of sRACIPE in this article. As our primary aim is to develop a robust framework for simulating gene expression profiles that can capture the experimental observations, we utilized the well established data structures from BioConductor to store the modeling results and parameters. We extend the <a href="http://bioconductor.org/packages/release/bioc/html/SummarizedExperiment.html">SummarizedExperiment</a> S4 class to create a new class RacipeSE to store and access the circuit/network, simulated gene expressions, parameters, intial conditions and other meta information. As for any S4 class objects, the slots should not be accessed directly and the getter and accessor functions should be used instead.</p>
</div>
<div id="configuration" class="section level2">
<h2 class="hasAnchor">
<a href="#configuration" class="anchor"></a>Configuration</h2>
<p>When a <code>RacipeSE</code> object is constructed, a <code>SummarizedExperiment</code> object is constructed and the default configuration is added as metadata. The default configuration is stored as a <code>configData</code> data object. These configuration parameters can also be passed as argumnets to <code>sracipeSimulate</code> function. The getter/accessor function for configuration is <code>sracipeConfig</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sRACIPE)))</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>racipe &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/RacipeSE.html">RacipeSE</a></span>() <span class="co"># Construct an empty RacipeSE object</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>racipe  <span class="co"># View the object. Notice the config in metadata. </span></span></code></pre></div>
<pre><code>## class: RacipeSE 
## dim: 0 0 
## metadata(1): config
## assays(0):
## rownames: NULL
## rowData names(0):
## colnames: NULL
## colData names(0):</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="../../reference/sracipeConfig.html">sracipeConfig</a></span>(racipe) <span class="co"># access the config</span></span></code></pre></div>
<pre><code>## $simParams
##         numModels    simulationTime integrateStepSize        printStart 
##              0.00             50.00              0.02             50.00 
##               nIC   outputPrecision       rkTolerance        paramRange 
##              1.00             12.00              0.01            100.00 
##     printInterval 
##             10.00 
## 
## $stochParams
##             nNoise noiseScalingFactor       initialNoise        scaledNoise 
##                0.0                0.5               50.0                0.0 
##          shotNoise 
##                0.0 
## 
## $hyperParams
##      prodRateMin      prodRateMax       degRateMin       degRateMax 
##           1.0000         100.0000           0.1000           1.0000 
##    foldChangeMin    foldChangeMax      hillCoefMin      hillCoefMax 
##           1.0000         100.0000           1.0000           6.0000 
## interactionTypes  thresholdModels         sdFactor 
##           3.0000        5000.0000           0.5658 
## 
## $options
##      anneal scaledNoise       genIC   genParams   integrate 
##       FALSE       FALSE        TRUE        TRUE        TRUE</code></pre>
<p>The config list includes other lists or vectors like <code>simParams</code>, <code>stochParams</code>, <code>hyperParams</code>, <code>options</code>, <code>thresholds</code> etc. The list <code>simParams</code> contains values for parameters like the number of models (<code>numModels</code>), simulation time (<code>simulationTime</code>), step size for simulations (<code>integrateStepSize</code>), when to start recording the gene expressions (<code>printStart</code>), time interval between recordings (<code>printInterval</code>), number of initial conditions (<code>nIC</code>), output precision (<code>outputPrecision</code>), tolerance for adaptive runge kutta method (<code>rkTolerance</code>), parametric variation (<code>paramRange</code>). The list <code>stochParams</code> contains the parameters for stochastic simulations like the number of noise levels to be simulated (<code>nNoise</code>), the ratio of subsequent noise levels (<code>noiseScalingFactor</code>), maximum noise (<code>initialNoise</code>), whether to use same noise for all genes or to scale it as per the median expression of the genes (<code>scaledNoise</code>), ratio of shot noise to additive noise (<code>shotNoise</code>). The list <code>hyperParams</code> contains the parameters like the minimum and maximum production and degration of the genes, fold change, hill coefficient etc. The list <code>options</code> includes logical values like annealing (<code>anneal</code>), scaling of noise (<code>scaledNoise</code>), generation of new initial conditions (<code>genIC</code>), parameters (<code>genParams</code>) and whether to integrate or not (<code>integrate</code>).</p>
<p>Metadata information also includes <code>annotation</code>, <code>nInteraction</code> (number of interactions in the circuit), <code>normalized</code> (whether the data is normalized or not), data analysis lists like <code>pca</code>, <code>umap</code>, cluster assignment of the models etc. These are added to the object in subsequent steps in the pipeline.</p>
</div>
<div id="circuit" class="section level2">
<h2 class="hasAnchor">
<a href="#circuit" class="anchor"></a>Circuit</h2>
<p><code>SummarizedExperiment</code> slot <code>rowData</code> is used to store the circuit topology. It is a square matrix with dimension equal to the number of genes in the circuit. The values of the matrix represent the type of interaction in the gene pair given by row and column. 1 represents activation, 2 inhibition and 0 for no interaction. The <code>sracipeCircuit</code> getter and accessor should be used to access this information. The <code>annotation</code> getter and setter set/get the name. Setting the circuit also adds <code>nInteractions</code> and <code>annotation</code> to the RacipeSE object.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"demoCircuit"</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw"><a href="../../reference/sracipeCircuit.html">sracipeCircuit</a></span>(racipe) &lt;-<span class="st"> </span>demoCircuit</span></code></pre></div>
<pre><code>## circuit file successfully loaded</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">annotation</span>(racipe) &lt;-<span class="st"> "demoCircuit"</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">annotation</span>(racipe)</span></code></pre></div>
<pre><code>## [1] "demoCircuit"</code></pre>
</div>
<div id="parameters-and-initial-conditions" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters-and-initial-conditions" class="anchor"></a>Parameters and initial conditions</h2>
<p><code>SummarizedExperiment</code> slot <code>colData</code> contains the parameters and initial conditions for each model. Each gene in the circuit has two parameters, namely, its production rate and its degradation rate. Each interaction has three parameters, namely, threshold of activation, the hill coefficient, and the fold change. Each gene has one or more initial gene expression values as specified by nIC. The corresponding getter and setter are <code>sracipeParams</code> and <code>sracipeIC</code>.</p>
</div>
<div id="simulated-gene-expression" class="section level2">
<h2 class="hasAnchor">
<a href="#simulated-gene-expression" class="anchor"></a>Simulated gene expression</h2>
<p>As such, sRACIPE can be used to simulate the trajectory for a single model with specific kinetic parameters or a large large number of models with randomized parameters. These sRACIPE models can be considered as separate samples/cells differing from each other in terms of the parameters reflecting the cellular heterogeneity. The <code>SummarizedExperiment</code> slot <code>assays</code> is used for storing simulated gene expressions. The rows of these matrix-like elements correspond to various genes in the circuit and columns correspond to models. The first element of the <code>List</code> is used for unperturbed deterministic simulations. The subsequent elements are used for stochastic simulations at different noise levels and/or knockout simulations. The name for each assay contains the information on the noise level (for stochastic simulations), knocked out gene (knockout simulations), or time (temporal simulations). The <code>assay</code> or <code>assays</code> accessor and getters from the SummarizedExperiment class should be used to access or modify these slots.</p>
</div>
<div id="time-series" class="section level2">
<h2 class="hasAnchor">
<a href="#time-series" class="anchor"></a>Time Series</h2>
<p>If one is interested in trajectories of a single model, then sRACIPE provides an argument <code>timeSeries</code> in the <code>sracipeSimulate</code> funcion. If enabled, sRACIPE will generate the trajectory for a single model and the corresponding plotting functions will also show time series plots. In such case, the trajectories are stored in <code>metadata</code> instead of <code>assays</code>. The use of <code>sracipeGetTS</code> function is recommended in this case.</p>
<p>Usually, sRACIPE only records the steady states or the simulated gene expression at the end of the simulation. But the model trajectories can also be recorded and analyzed using sRACIPE using the variables <code>printInterval</code> and <code>printStart</code>. These variables define how often the simulated gene expressions are recorded. Thus, one can record multiple time points during the model simulations. If intermediate time points are also recorded, then the first element will contain the last (steady-state) solutions and the other slots will contain the values at the intermediate time points. For more details on temporal simulations of large number of models, please refer to the corresponding article.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#configuration">Configuration</a></li>
      <li><a href="#circuit">Circuit</a></li>
      <li><a href="#parameters-and-initial-conditions">Parameters and initial conditions</a></li>
      <li><a href="#simulated-gene-expression">Simulated gene expression</a></li>
      <li><a href="#time-series">Time Series</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://vivekkohar.github.io/">Vivek Kohar</a>, <a href="http://lusystemsbio.com/">Mingyang Lu</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
